---
title: "E5_Grupo5"
author: "Fernando Pérez, Cristóbal Marchant, Sergio Espinoza, Clemente Aguilar"
date: "2023-05-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(ez)
```

Hipotesis nula: no existen diferencias en el tiempo que tardan los usuarios en formular una consulta para un problema de dificultad fácil en las áreas de biología, economía y computación.
Hipotesis alternativa: existen diferencias en el tiempo que tardan los usuarios en formular una consulta para un problema de dificultad fácil en las áreas de biología, economía y computación.

```{r}
data <- read.csv("EP05 Datos.csv", sep = ";", fileEncoding = "ISO-8859-1")

# Filtramos solo los datos que nos interesan
simple_data <- subset(data, dificultad == 'Baja' & (area == 'Biología'| area == 'Economía'|area == 'Computación'))

# Convertimos los tipos y lo guardamos en un nuevo dataframe
area <- as.factor(simple_data$area)
tiempo <- as.numeric(gsub(",", ".", simple_data$tiempo))
final_data <- data.frame(area = area, tiempo = tiempo)

# Comprobacion de normalidad
g <- ggqqplot (final_data , x = "tiempo" , y = "area" , color = "area" )
print(g)

Biologia <- subset(final_data, area == 'Biología')
Economia <- subset(final_data, area == 'Economía')
Computacion <- subset(final_data, area == 'Computación')

# Comprobacion de homocedasticidad
sdb <- sd(Biologia$tiempo)
sde <- sd(Economia$tiempo)
sdc <- sd(Computacion$tiempo)
sdb/sdc  # Como menor o igual a 1.5 queda comprobado

# Analisis de varianza
summary(aov(tiempo~area, final_data))

# No es necesario usar analisis post-hoc ya que no hay diferencias significativas pero lo haremos por motivos academicos
bonferroni <- pairwise.t.test(final_data[["tiempo"]],
                              final_data[["area" ]],
                              p.adj = "bonferroni" ,
                              pool.sd = TRUE,
                              paired = FALSE ,
                              conf.level = 1 - alfa )
print(bonferroni)

```


