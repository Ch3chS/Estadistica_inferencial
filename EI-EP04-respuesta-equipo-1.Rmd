---
title: "EI-EP04-respuesta-equipo-1"
author: ""
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggpubr)
library(pwr)
library(tidyverse)
library(RVAideMemoire)
library(rcompanion)
```

# Preguntas

## Pregunta 1

Una popular discoteca quiere analizar el interés que generan los concursos de baile entre sus visitantes
más asiduos. Para ello ha invitado a sus mejores clientes, 8 hombres y 10 mujeres, a un evento privado
con la posibilidad de participar en un concurso. 8 mujeres y 1 hombre decidieron participar. ¿Influye el
género en la participación en concursos de baile?

Se quiere determinar si influye el género en la participación para un concurso de baile, es decir la independencia o no del sexo referente a la decisión de bailar.
Debido a que ambas variables presentes en el problema son dicotómicas, se decanta por la prueba de Fisher, descartando la prueba de Chi cuadrado de Independencia, de la cual deriva la prueba a utilizar.

Planteamiento de hipótesis:

H0: el sexo es independiente al decidir si bailar

HA: el sexo es dependiente al decidir si bailar

```{r}
#Prueba exacta de fisher

#Se establecen los datos de las variables
sexo = c(rep("Hombre", 8), rep("Mujer", 10))
bailable = c(rep("Baila", 9), rep("No baila", 9))

#Se crea el data el dataframe y se imprime
datos = data.frame(sexo, bailable)
tabla_preg1 = xtabs(~., datos)
print(tabla_preg1)

```

```{r}
#Se establece el nivel de confianza
alfa = 0.05

#Se realiza el fisher test, con el dataframe y la confianza
prueba_preg1 = fisher.test(tabla_preg1, 1-alfa)
print(prueba_preg1)
```

Al utilizar Fisher Test de obtiene un p-value de 0.0004114, se estableció un nivel de confianza de 0.05, por lo que al ser mayor que el p-value calculado se rechaza la hipótesis nula y se acepta la alternativa.
En conclusión del Fisher test se sabe con un 95% de confianza que el género si influye al momento de participar o no en el concurso de baile.

## Pregunta 2

En un estudio acerca del efecto de la deficiencia de vitamina B1 durante la infancia temprana, Katz, Haltus
& Friedmann (2022) (Journal of Neurolinguistics, 62(5), 101042) concluyeron que tal carencia se traduce
en severos problemas de lenguaje. Un nuevo estudio busca verificar este hallazgo, para lo cual ha
evaluado el desarrollo del lenguaje a los 5 años de vida de 35 parejas de gemelos idénticos donde, por
razones médicas, los bebés son alimentados con diferentes fórmulas (una carente de vitamina B1 y la
otra, no). Los datos registrados muestran que:
* En 10 parejas de gemelos, ninguno presenta trastornos del lenguaje.
* En 5 parejas de gemelos, ambos presentan trastornos del lenguaje.
* En 9 parejas de gemelos, solo aquel que fue alimentado con la fórmula que sí contiene vitamina B1 desarrolla trastornos del lenguaje.
* En las 11 parejas de gemelos restantes, solo el gemelo con carencia de vitamina B1 presenta
trastornos del lenguaje.
¿Soportan los nuevos datos la conclusión del estudio original?

Dado que se tiene si un gemelo presenta o no trastornos del lenguaje, lo cual es una característica con respuesta dicotómica 
y se tiene una medición para gemelos (muestras pareadas) con deficiencia de B1 y sin deficiencia, en donde se busca concluir sobre si hay cambios significativos entre los gemelos sobre el trastorno del lenguaje.
Con lo anterior se plantean las siguientes Hipótesis:

H0: NO hay cambios significativos en el trastorno del lenguaje si se carece de vitamina B1 en la alimentación.
HA: SI hay cambios significativos en el trastorno del lenguaje si se carece de vitamina B1 en la alimentación.

```{r}
#Prueba de mcNemar
#Construccion de la tabla de contingencia para realizar el test
gemelos = seq (1:35)
con_b1 = c (rep( "Sin trastorno", 10), rep("Con trastorno", 5), rep("Con trastorno", 9), rep("Sin trastorno", 11))
sin_b1 = c (rep( "Sin trastorno", 10), rep("Con trastorno", 5), rep("Sin trastorno", 9), rep("Con trastorno", 11))
datos_preg2 = data.frame(gemelos, con_b1 , sin_b1)
tabla_preg2 = table(sin_b1 , con_b1)
print(tabla_preg2)
#Realizacion del test de mcNemar
prueba_preg2 = mcnemar.test(tabla_preg2)
print(prueba_preg2)
```

Dado que el p-value es 0.8231 para un nivel de significancia del 0.05 se falla al rechazar la hipótesis nula, en consecuencia se puede concluir con un 95% de confianza que NO hay cambios significativos en el trastorno del lenguaje si se carece de vitamina B1 en la alimentación.


## Pregunta 3

En su afán de comprender mejor a sus eternos enemigos, los vampiros, Van Helsing ha decidido estudiar
si vampiresas y vampiros tienen preferencias similares en cuanto al tipo sanguíneo de sus víctimas. ¿Qué
puede concluir a partir las preferencias alimentarias de estos seres de acuerdo a sus registros, mostrados
en la siguiente tabla?

Como bien dice el enunciado, tenemos presente a los vampiros y las vampiresas , lo que indica las variables dicotómicas y  los tipos de sangre corresponderían a la variable categórica con 4 niveles en este caso. Como se quiere saber si los vampiros y vampiresas tienen alguna preferencia sobre el tipo de sangre se ocupará la prueba chi-cuadrado de homogeneidad, ya que esta prueba permite determinar si dos poblaciones presentan o no las mismas proporciones con respecto a las variables categóricas.
En caso de que tengan las mismas preferencias, se espera que las proporciones sean similares.

Para ocupar la prueba, se plantean las siguientes hipótesis: 

H0: los vampiros y las vampiresas tienen las mismas preferencias en cuanto al tipo de sangre.

HA: las elecciones de los vampiros y las vampiresas en cuanto a el tipo de sangre que prefieren, difieren.

```{r}
#chi-squared de homogeneidad

#Crear tabla de contingencia
vampiro = c(15, 12, 8, 6)
vampiresa = c(9, 14, 5, 7)

tabla_preg3 = as.table(rbind(vampiro, vampiresa))

dimnames(tabla_preg3) = list(sexo = c("vampiro", "vampiresa"),
                       tipo_sanguineo = c("A", "B", "AB", "O"))

print(tabla_preg3)
```

```{r}
#Prueba Chi cuadrado de homogeneidad
prueba_preg3 = chisq.test(tabla_preg3)
print(prueba_preg3)
```

El p-value arrojado por la prueba tiene un valor de 0.58 aproximadamente, por lo que se acepta la hipótesis nula, es decir que los vampiros y vampiresas tienen preferencias similares en cuánto al tipo de sangre que consumen.

## Pregunta 4

La Facultad de Ingeniería desea saber si existe diferencia significativa en el desempeño de los estudiantes
en asignaturas críticas de primer semestre. Para ello, le ha entregado un archivo de datos que, para 3
asignaturas, indica si una muestra de 50 estudiantes aprobó o reprobó. ¿Qué puede concluir la Facultad?
Indicación: obtenga la muestra a partir del archivo “EP04 Datos.csv” que se encuentra en el directorio
compartido, usando la semilla 102. Considere un nivel de significación α=0,05.

Por un lado se tiene la variable dicotómica de aprobado/rechazado, y se tiene la variable con más de dos observaciones pareadas correspondiente a los cursos del estudiante, sea cálculo, álgebra o física. Considerando los tipos de variables que se presentan en el problema y que se espera saber si existe una diferencia significativa de los estudiantes en las asignaturas mencionadas se escoge la prueba de Q de Cochran.

Se verifica si se cumplen las condiciones para la presente prueba:
1. La variable de respuesta, es decir la aprobación del curso es dicotómica, lo cual es cierto.
2. La variable independiente es categórica, lo que es cierto ya que los cursos se pueden categorizar.
3. Las observaciones son independientes entre si ya que se consideran diferentes alumnos.
4. Ya que n=50 (número de casos) y k=3 (tres niveles de variable categórica) se verifica que n*k >= 24, lo cual es cierto.

En base a la verificación realizada se aplica la prueba Q de Cochran estableciendo las siguientes hipótesis:

H0: La proporción de aprobados para todas las asignaturas es la misma para los estudiantes.

HA: La proporción de aprobados para todas las asignaturas es distinta para los estudiantes.

```{r}
#Prueba Q de Cochran
datos_preg4 = read.csv("EP04 Datos.csv")

#Se obtiene una muestra de 50 estudiantes
datos_preg4 = datos_preg4[1:50,]

#Se transforman los datos a formato largo para ser usados en el test
datos_preg4 = datos_preg4 %>% pivot_longer(c("Calculo" , "Algebra" , "Fisica"), names_to = "ramos", values_to = "resultado")

#Se pasan a factor los valores de Id y Ramos para hacer el test
datos_preg4[["Id"]] = factor(datos_preg4[["Id"]])
datos_preg4[["ramos"]] = factor(datos_preg4[["ramos"]])

#Se realiza el test de Cochran
prueba_preg4 = cochran.qtest(resultado ~ ramos | Id, data = datos_preg4, alpha = 0.05)
prueba_preg4
```

Se obtuvo un p-value de 0.4794 teniendo el nivel de significancia dado de 0.05, por lo tanto el p-value es mayor, por ende se falla en rechazar la hipótesis nula en favor de la alternativa, teniendo así que no existe diferencia significativa en el desempeño de los estudiantes en asignaturas críticas de primer semestre, ya que la proporción de aprobación es la misma en las 3 asignaturas evaluadas para los estudiantes.