---
title: "E01_Grupo5"
author: "Clemente Aguilar, Fernándo Pérez, Sergio Espinoza y Cristóbal Marchant"
output: html_document
date: "2023-03-17"
---
 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Actividad 1 Grupo 5

Integrantes: Clemente Aguilar, Fernándo Pérez, Sergio Espinoza y Cristóbal Marchant.

Se deben obtener los datos e información necesaria para saber si son similares o no los ingresos registrados en las diferentes provincias de la Región Metropolitana a partir de los datos presentes.

```{r }
# Importacion de librerias
library(dplyr)
library(ggpubr)
```

Lo primero que se realiza es leer los datos correspondientes y guardar la informacion

```{r}
# Lectura de datos
data <- read.csv2("EP01 Datos Casen 2017.csv", stringsAsFactors = TRUE)
onlyRM <- data %>% filter(region == "Región Metropolitana de Santiago")
provincias <- levels(onlyRM$provincia)
```

Luego se procede a realizar un filtro, obteniendo la media y desviación estándar de cada una de las provincias gracias a la funcion summarise, junto a mean y sd.

```{r}
# Filtro de datos y calculo de media y desviacion estandar por provincias
Descriptiva <- summarise(onlyRM %>% group_by(provincia), 
                         Media = mean(ytot), 
                         Desviacion_estandar = sd(ytot)
                         )
```

Primero se hará uso de los ingresos promedio por provincia y se realizará un grafico de caja

```{r}
# Se crea dataframe con los datos necesarios para graficar la media
tabla_media <- data.frame(Provincia = Descriptiva$provincia, Media = Descriptiva$Media)

# Se realiza el grafico de barras
g <- ggplot(tabla_media, aes(x=Provincia, y= Media, fill= Provincia)) + 
  geom_bar(stat = "identity") + 
  labs(title="Media de los ingresos de cada provincia", x="Provincias", y="Media") +
  scale_y_continuous(labels = scales::comma_format()) +
  scale_fill_discrete()

# Se muestra el grafico
print(g)
```

Para el caso de las desviaciones estandar, se realizara un gráfico de caja. Sin embargo, las cajas resultantes son muy pequeñas.

```{r}
# Se crea dataframe con los datos necesarios para graficar la desviacion estandar
tabla_sd <- data.frame(Provincia = Descriptiva$provincia, Desviacion_Estandar = Descriptiva$Desviacion_estandar)

# Grafico de caja
g2 <- ggplot(tabla_sd, aes(x = Provincia, y = Desviacion_Estandar, fill = Provincia)) +
      geom_boxplot(color = "orange", outlier.shape = NA) +
      labs(title = "Graficos de la desviación estandar", x = "Provincia", y = "Desviación estándar") +
      scale_y_continuous(labels = scales::comma_format()) +
      scale_fill_hue() +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Mostrar grafico de caja
print(g2)
```

Como se puede apreciar de la media y desviación estándar obtenida para cada provincia en los gráficos anteriores, existe una gran diferencia entre los ingresos obtenidos entre provincias. Si bien la media de cada provincia permite fijar una tendencia que describe la realidad de cada una, el comportamiento de la desviacion en ingresos de las 6 provincias muestran cómo varían estos ingresos de cada media, destacando la provincia de Santiago que tiene la mayor dispersión de ingresos en la Región Metropolitana.